Network theory has been applied to connectomes at multiple scales
to understand brain-wide organization6–12. Such analyses quantify the
interconnectivity and robustness of a network13 and can identify highly
connected nodes that may act as hubs14. They also serve as a basis for
comparison across brain regions, individuals, developmental stages
or species, enabling researchers to identify commonalities and differences
in brain organization.
Mesoscale connectomes have been constructed for the brains of
humans and other mammals from MRI and MEG data6,15,16, relying
on functional activity correlations to infer connectivity at the millimetre
scale. Rich-club organization has been observed in several mesoscale
connectomes: in humans, other mammals8,9,17 and light-level
(not synaptic resolution) connectomes in Drosophila18,19. Rich-club
organization has been proposed to contribute to the ability of brains
to efficiently integrate and disseminate information. Advancements
in electron microscopy and dense volumetric reconstruction have
enabled researchers to examine increasingly larger brain networks
at the microscale. These methods do not make assumptions about
the relationship between neuron connectivity and functional correlations;
nodes and edges can be directly related to neurons and synaptic
connections. For example, rich-club neurons in Caenorhabditis
elegans are part of well-studied motor control circuits7,20,21. Patterns
of neuronal connectivity that reoccur in different brain areas, known
as motifs, have been proposed as ‘building blocks’ of networks22,23,
and their prevalence in neural networks has been studied to identify
organizational principles7,10–12,24–26. Motifs such as reciprocal connections7,11,12,21,27,
feedforward loops7,24,25 and 3-unicycles12 have received
considerable attention in neuroscience owing to their implications
for local computation and information flow.
In this study, we characterize the network properties of the wholebrain,
synapse-resolution connectome generated by the Flywire
Consortium3,5, the first complete wiring diagram of an adult brain,
that of a female Drosophila melanogaster1, and we lay the groundwork
for future experimental and theoretical studies in this model system.
A summary of data products can be found in Table 1.
Summary of the dataset and definitions
Here we analyse the v630 snapshot of the Drosophila connectome as
a directed weighted graph (information on the differences between
v630 and v783 is provided in the Methods). Synapses were detected
automatically28 and, for each α→β neuron pair, the total number of
synapses between two neurons defines the connection weight (which
we consider to be a proxy for connection strength). Consistent with
the flagship connectome paper3, we applied a threshold of five synapses
per connection, unless otherwise noted (Methods); however,
we also examined the robustness of several results to variation in the
synapse threshold (Extended Data Fig. 1b,c and Extended Data Table 2).
This gives us a graph with 127,978 neurons and 2,613,129 connections3
(Fig. 1a and Methods). The connectome also contains synapse-level
neurotransmitter predictions4. The classifier discriminates between
six neurotransmitters: the fast-acting classical neurotransmitters acetylcholine
(ach), GABA and glutamate (glut), and the monoamines
dopamine (da), octopamine (oct) and serotonin (ser). In Drosophila,
ach is excitatory and GABA is inhibitory. Glutamate can be either excitatory
or inhibitory, but within the brain of the fly, it has largely been
observed to be inhibitory29,30.
The distribution of degrees reflects the amount of connectivity
between neurons. A neuron’s in-degree is defined as the number of
presynaptic partners, and the out-degree is defined as the number of
postsynaptic partners. The average in/out-degree of an intrinsic neuron
in the brain is 20.5 (ref. 3), but in-degree and out-degree are not highly
correlated (Pearson R = 0.76, P < 0.001; Fig. 1c). The average connection
consists of 12.6 synapses3, and the connection probability is 0.000161.
This makes the fly brain a very sparse matrix when compared with the
C. elegans nervous system or the partial wiring diagrams of larval
zebrafish and mouse, with or without a threshold applied (Table 2,
Extended Data Table 2 and Extended Data Fig. 1c). This sparsity is
due in part to the size of the fly brain. The connection probability is
highest among neurons with nearby arbours. Only 3% of neuron pairs
have arbours within 50 μm of each other, but such pairs make 71% of all
connections (Extended Data Fig. 1d). However, even in this close regime,
the connection probability (the likelihood that any two neurons are
connected) in the fly is lower than in other wiring diagrams.
Neurons form one connected component
To assess interconnectivity, we searched for strongly (SCCs) and weakly
(WCCs) connected components (Methods). Despite its sparsity, the
brain forms a highly connected network—93.3% of neurons are contained
in a single SCC, while 98.8% of neurons are contained in a single
WCC (Fig. 1d,e). These giant connected components, which contain
the majority of neurons, persist when either the strongest or weakest
connections are pruned (Extended Data Fig. 1a) and are robust to
threshold choice (Extended Data Fig. 1b), indicating that connectivity
is robust: many paths connect neuron pairs. Within the giant SCC, the
average shortest directed path length between neuron pairs is 4.42 hops,
with every neuron reachable within 13 hops (Fig. 1d). In the giant WCC,
the average shortest undirected path length between neuron pairs is
3.91 hops, with every neuron reachable within 11 hops (Fig. 1e). These
numbers are comparable to those found in a similar analysis of the hemibrain
dataset31. The short path lengths show that the fly brain is relatively
shallow compared with artificial networks. The similarities in size and
path length distribution between the giant SCC and WCC highlight the
prevalence of recurrent connections in the brain: in a mostly feedforward
network, one would expect a smaller first SCC with longer path lengths.
To assess whether high interconnectivity is a consequence of a relatively
large number of interconnected neurons, or a small number of
very highly connected neurons, we constructed survival curves, observing
whether large connected components persist when neurons are
removed. Removing neurons from the directed network, starting with
those of largest total degree, we find that the first SCC persists until a
total degree of 50, at which point the network splits into two SCCs of
roughly equal size (Fig. 1f). These two SCCs correspond to the left and
right hemispheres, and do not split into separate networks until about
60% of neurons are removed. Removing neurons from the network by
smallest total degree does not result in division of the first SCC (Fig. 1g).
These results highlight the brain’s robust interconnectivity—it is not
dependent on a small population of neurons. We observed similar
behaviour in the undirected network (Extended Data Fig. 2a,b). These
results remain qualitatively consistent when neurons are removed by
in-degree or out-degree alone (Extended Data Fig. 2c,d).
Spectral analysis of the brain
To better understand the brain’s topology, we performed a spectral
analysis of a random walk in the giant SCC (Methods), which converges
to a stationary distribution over all neurons in which 3% of neurons
were visited 61.2% of the time (Extended Data Fig. 1f). These top-visited
neurons are classified as attractor nodes. These attractors often make
connections in the gnathal ganglia (GNG), a large midline neuropil
that sends and receives information from the periphery and contains
many connections to the ventral nerve cord (VNC). We also performed
a reverse walk within the giant SCC, which converges to a stationary
distribution in which 3% of neurons were visited 42.4% of the time
(Extended Data Fig. 1g). These neurons are repeller nodes, and include
many with synapses in the antennal lobes (AL) and medullae (ME),
brain regions that are close to the olfactory and visual periphery,
respectively.
The fly brain has a large rich club
Many networks exhibit the rich-club property8,14,20, in which wellconnected
nodes are preferentially connected to other well-connected
nodes (Methods). Comparing the observed network to a degreepreserving
configuration (CFG) random model, there exists a rich-club
regime in the fly brain, with a cut-off of total degree = 37 (Fig. 1h and
Extended Data Fig. 2e–g). This regime contains 40,218 neurons,
approximately 30% of neurons in the brain (Extended Data Fig. 2e).
The connection probability within the rich club is 0.000870, 5.4 times
higher than the overall connection probability. The size of the rich club
suggests that the network topology of the fly brain is fairly distributed,
consistent with the connected component results. A rich-club
analysis considering in-degree alone finds a rich-club regime with an
in-degree threshold of 10, while no rich club is observed when considering
out-degree alone (Extended Data Fig. 2f). Note that, as we continue
to remove nodes, we enter a regime (beyond total degree 92) where
the remaining neurons are no longer preferentially connected to each
other (Fig. 1h). We further consider this very-high-degree regime in
the Discussion.
To examine the extent to which long-distance connections contribute
to the rich-club property that we observe in the fly brain, we constructed
an extension of the CFG model in which we constrain the random network
by enforcing the measured connection probabilities between the
78 neuropils. By fixing the number of connections between and within
neuropils, this neuropil connection (NPC) model implicitly contains
mesoscale spatial information (Methods). We find that the observed
network is not more highly connected than the NPC model (Extended
Data Fig. 2g), indicating that interneuropil connections contribute to
the rich-club effect.
The fraction of neurons in the rich-club regime in the fly is substantially
larger than in C. elegans, which has a rich club of 11 neurons (4% of
the neurons in the worm)20. Note that the differences in rich-club size
are sensitive to the criteria used to determine the rich-club cut-off, and
may also be a consequence of the different scales of these two networks.
Nonetheless, it is interesting to note that, while the worm rich club
contains known hub neurons, such as the command neurons AVA and
AVB, such highly connected hub neurons do not seem to be present in
the fly brain—although there are neurons with very high degrees, there
also exist alternative paths between most neuron pairs.
Recurrent motifs are over-represented
Connection reciprocity is a measure of the amount of direct feedback
in the brain. Across the brain, this connection reciprocity probability
is 0.138 (Table 2), higher than in both the Erdős–Rényi (ER) and CFG
random models (Methods). The over-representation of reciprocal
connections in brains is well established, and our results are consistent
with previous observations both in Drosophila31–33 and in other
species7,11,21,24,25,34. The clustering coefficient, a metric that assesses
the prevalence of triplet structures in the network, is 0.0477 in the fly
brain (Table 2), higher than in both the ER and CFG models. The high
clustering coefficient demonstrates that the network is highly connected
and is non-random in its structure.
We present these metrics alongside those for two existing wholeanimal
connectomes, the hermaphrodite and male C. elegans7,21,35, and
two subvolume wiring diagrams, the hindbrain of a larval zebrafish12
and a region of L2/3 mouse visual cortex11 (Table 2). Despite differences
in the sparsity of the different brain networks, the values of
reciprocity and clustering coefficient are comparable across all five
datasets. The ER and CFG models do not contain any spatial information,
instead assuming that any neuron pair may randomly connect. Our
NPC model contains mesoscale spatial information but does not make
distance comparisons for each neuron pair. We therefore constructed a
neuron–neuron distance (NND) model with two different spatial zones
of connection probability, informed by the distribution of connections
as a function of distance (Methods and Extended Data Fig. 1e).
We computed the reciprocity and clustering coefficient for both the
NND and NPC models and found that the metrics for the real network
were higher than in both spatial null models, suggesting that the nonrandom
connectivity observed in the brain is not solely a consequence
of spatial or morphological constraints.
Direct comparisons of networks of different sizes should be interpreted
with caution36–38. While the fly and worm datasets are complete
brains, the zebrafish and mouse datasets are derived from brain
subvolumes with truncated neurons. Moreover, differences in synapse
detection and thresholding will impact topological metrics such as
connection probability and reciprocity (Discussion). Varying the synapse
threshold in the fly did not substantially change these metrics
(Extended Data Fig. 1c and Extended Data Table 2).
Small-worldness of the fly brain
A small-world network is one in which nodes are highly clustered
and path lengths are short13. High small-worldness coefficients are
associated with efficient communication between nodes39. The
small-worldness coefficient of the whole-brain fly connectome is
SΔ = 141, higher than that of the C. elegans connectome (SΔ = 3.21) and
close to that of the internet (SΔ = 98.1)13, implying highly effective global
communication among neurons in the brain.
Neurotransmitter makeup of reciprocal connections
The average strength of edges participating in reciprocal connections is
higher than the average strength of unidirectional connections (Fig. 2a).
The majority of unidirectional connections are cholinergic (excitatory),
while the edges participating in reciprocal connections contain fewer
cholinergic neurons and more GABAergic neurons (Fig. 2b). Inhibitory
connections in the brain have more synapses on average compared
with excitatory connections3, which may partially explain the
higher average strength of reciprocal connections. The most common
reciprocal pairing is ach–GABA, and the second most common
pairing is ach–glutamate (Fig. 2c). Both of these reciprocal motifs are
excitatory–inhibitory, and both are over-represented when compared
to the neurotransmitter frequencies observed for reciprocal connections
(Fig. 2b). By contrast, excitatory–excitatory ach–ach pairs are
under-represented, as are inhibitory–inhibitory GABA–GABA pairs. We
observed reciprocal excitatory–inhibitory (ach–GABA and ach–glut)
connection strengths to be only weakly correlated, whereas ach–ach
pairs were uncorrelated (Fig. 2d). Examples of reciprocal neuron pairs
are shown in Fig. 2g.
Reciprocal degree across the population
Of the 127,978 neurons in the brain, 77,607 participate in at least one
reciprocal connection: approximately 2 in every 3 neurons (Methods).
Many neurons participate in multiple reciprocal connections. We define
reciprocal degree as the number of reciprocal connections made by
a given neuron (Extended Data Fig. 3a). Plotting the distributions of
reciprocal degree by neurotransmitter, we observe that the majority
of neurons with a high reciprocal degree (drec > 100) are GABAergic
(Fig. 2e and Extended Data Fig. 3b), while, at lower reciprocal degrees
(drec < 100), all three primary neurotransmitter types are well
represented.
For most neurons, the fraction of reciprocal connections is low—on
average 23% of incoming and 18% of outgoing connections are reciprocal.
Plotting the fraction of reciprocal incoming connections against
the fraction of reciprocal outgoing connections, we observed only a
weak correlation (Extended Data Fig. 3c), suggesting that the reciprocal
degree is not strongly coupled to either in-degree or out-degree.
Similarly, there is no relationship between the total degree and the
reciprocal degree (Fig. 2f). However, dividing the neuron population by
neurotransmitter, we find that neurons of high total degree are mostly
GABAergic and, for many of these neurons, more than half of their total
connections are reciprocal (Extended Data Fig. 3d).
Neurotransmitter composition of three-node motifs
The high clustering coefficient of the brain implies an overrepresentation
of triplet structures. We determined the frequency
at which each of the 12 directed three-node motifs occur in the brain
(Fig. 3a). Feedforward motifs (motifs 1–3) are under-represented when
compared to both ER and CFG models, while all others, including
the highly recurrent motifs (motifs 7–13), are over-represented. The
strengths of edges participating in three-node motifs are higher than the
average edge strength (Fig. 3b). Complex three-node motifs that contain
reciprocal connections tend to be stronger than feedforward motifs.
Examining the neurotransmitter composition of two of these motifs,
feedforward loops (motif 4) and 3-unicycles (motif 7) (Fig. 3c), we found
that edges that participate in feedforward loops were predominantly
cholinergic, and that the most common neurotransmitter composition
is three cholinergic neurons, a feedforward excitatory configuration
(Fig. 3d). The next most common compositions contain either one
or two inhibitory (GABAergic or glutamatergic) edges. Feedforward
loops with one inhibitory edge are probably feedforward inhibition
motifs, whereas loops with two inhibitory edges are probably disinhibition
motifs. By contrast, 3-unicycles contain a higher proportion of
inhibitory GABAergic and glutamatergic neurons, and the three most
common 3-unicycle compositions all contain at least one inhibitory
neuron (Fig. 3e). These cycles may act as indirect feedback inhibition
circuits. Notably, observed neurotransmitter composition frequencies
are closer to what may be expected by chance for feedforward loops
than for 3-unicycles. Examples of neurons that form three-node motifs
are shown in Fig. 3f.
A high clustering coefficient and an over-representation of highly
connected motifs suggest that the local structure of the brain displays
a high degree of non-randomness, consistent with previous studies in
C. elegans7,21 and in the mouse cortex11,24,25. The over-representation
of feedforward loops has been widely observed in other biological
networks, such as in the rat cortex and C. elegans7,21,24,25. This
over-representation is present in most neuropils in the brain.
Large-scale connectivity in the brain
Neurons with few inputs and many outputs may function as broadcasters
of signals, while those with many inputs and few outputs may
act as integrators. To examine such neurons, we divided the intrinsic
rich-club neurons into three categories on the basis of their relative
in-degree and out-degree (Fig. 4a), defining broadcasters as those for
which out-degree ≥ 5 × in-degree and integrators as those for which
in-degree ≥ 5 × out-degree. These definitions, while arbitrary, enable
us to describe neuron populations with unbalanced in-/out-degrees.
Given these definitions, we find 676 broadcasters and 638 integrators.
The remaining intrinsic rich-club neurons (37,093), including most
highly reciprocal neurons, fall into the balanced category.
In comparison to the overall population, rich-club neurons are less
likely to be cholinergic and more likely to be GABAergic (Fig. 4b and
Extended Data Fig. 4a). Integrators are even less likely to be cholinergic
(49%), and include a large fraction of dopaminergic neurons that
may be engaged during learning. By contrast, broadcasters are predominantly
cholinergic (75%). Central brain neurons are substantially
over-represented in the rich club, while optic lobe intrinsic neurons
are under-represented (Fig. 4c and Extended Data Fig. 4b). Many integrators
are either central-brain-intrinsic neurons or visual projection
neurons, while few broadcasters are intrinsic to the central brain—many
are visual centrifugal neurons or optic lobe intrinsic neurons. Broadcasters
include a large number of Mi1 and Tm3 neurons—excitatory
cells in the ME known to have key roles in the motion detection circuit32,40.
Most neurons are restricted to a single hemisphere—11% have
inputs in both hemispheres and 11% have outputs in both hemispheres3
(Extended Data Fig. 4c). Rich-club neurons are more likely to have inputs
or outputs spanning both hemispheres: 18% and 17%, respectively. This
is more common for integrators (23%) than for broadcasters (16%).
Some examples of broadcasters, integrators and balanced neurons
are shown in Fig. 4d.
The rich club is close to sensory inputs
To assess the distance of the rich-club neurons from sensory inputs,
we used a probabilistic information flow model to determine the relative
distance of each neuron from a set of seed neurons3,41 (Methods).
The model was run with different sets of seed neurons, each corresponding
to a specific set of sensory inputs to the brain (olfactory,
gustatory and so on). This includes all sensory receptors projecting
to the central brain as well as the population of visual projection neurons
(which provide visual input to the central brain and were used
here instead of the photoreceptor neurons, inputs to the optic lobe,
because photoreceptor
proofreading was incomplete in v630 of the
data). Ranking these distances and normalizing returned the percentile
rank of each neuron with respect to each modality. Neurons with
percentile rank < 50% are closer than average to the given input, while
neurons with percentile rank > 50% are farther.
The rich-club neurons have a mean percentile rank of 44% relative to
the set of all sensory inputs (Fig. 4e). Integrators have a mean percentile
rank of 43%, while broadcasters have a mean percentile rank of 53%. The
distribution of broadcasters is bifurcated, with one peak closer to inputs
and another peak far from inputs. The second peak consists primarily of
broadcasters in the optic lobe, which are far from sensory inputs to the
central brain (Extended Data Fig. 4d). Examining the ranks with respect
to individual sensory modalities, we find that rich-club neurons are again
closer than average to each modality (Fig. 4f and Extended Data Fig. 4e).
Examining the distance of neurons to multiple sensory modalities, we
find that broadcasters and integrators, while scattered throughout
these distributions, tend to be closer than average to multiple sensory
inputs (Extended Data Fig. 4f). Integrators and broadcasters that are
low in rank relative to multiple modalities may be candidate sites of
multisensory integration and information propagation.
Network differences across brain regions
The Drosophila connectome has been segmented into 78 neuropils
(Fig. 5a), each with different average connection strengths3. To
understand information flow between neuropils, we used a fractional
weighting method accounting for each neuron’s projections to and
from every neuropil3 (Methods). We computed for each neuropil the
relative fraction of internal, external incoming and external outgoing
connection weights (Extended Data Fig. 5a,b). These fractions reflect,
respectively, the net number of connections within, being received and
being sent from each neuropil.
We find differences in these fractions across brain regions: the ellipsoid
body (EB) and fan-shaped body (FB) of the central complex have
the highest fraction of internal connections, while in other regions, such
as the mushroom body (MB), the majority of connections are external
(Extended Data Fig. 5b). Some regions, such as the lateral horn, send
more connections than they receive, while others, such as the lobula
plate, receive more connections than they send. The fraction of internal
connection weights is not correlated with neuropil size: while large
neuropils such as the anterior and posterior ventrolateral protocerebra
(AVLP and PVLP) have sizable fractions of internal weights, they do not
rank the highest. Note that internal weights include any neurons with
endings outside the brain, such as sensory, ascending and descending
neurons, accounting for the high fraction of internal weights in regions
such as the ME, which receive inputs from R7 and R8 photoreceptors,
and the GNG, which connects with large numbers of ascending and
descending neurons. Across the brain, 52% of all connection weights
can be classified as internal. Comparing the neurotransmitters of the
neurons contributing connection weights, we see that internal connections
are more likely than external ones to be inhibitory (GABAergic or
glutamatergic) (Extended Data Fig. 5c). We also see differences in the
neurotransmitter composition across regions (Extended Data Fig. 5d).
Reciprocal connections in neuropils
To perform motif analyses within each neuropil, we identified neuropil
subnetworks that treat all connections within a neuropil as edges
(Fig. 5b and Extended Data Fig. 6a). Different neuropils differ in connection
strength and density (Extended Data Fig. 6b). Computing the
reciprocity in each neuropil (Fig. 5c and Extended Data Fig. 6c), we
found regions with high reciprocity probabilities, including the central
complex (FB, EB and noduli (NO)) and the ALs. The relative number of
reciprocal connections is high in the MB and ME (Extended Data Fig. 6b).
Note that, for these motif analyses, the results for small neuropils such
as the cantles, bulbs, galls, accessory ME and ocellar ganglion are less
interpretable owing to the small number of neurons.
In most neuropils, as in the whole brain, reciprocal connections are
stronger than unidirectional connections (Extended Data Fig. 6d).
Exceptions include the protocerebral bridge, MB calyces and bulbs,
which have stronger unidirectional than reciprocal connections. There
are differences in the relative prevalence of each neurotransmitter in
reciprocal and unidirectional connections across neuropils (Fig. 5d,e
and Extended Data Fig. 6d–h): while, in most neuropils, reciprocal connections
contain fewer cholinergic and more GABAergic edges, there
are notable exceptions, such as in the neuropils of the central complex
(FB, EB, protocerebral bridge and NO). In the MB, we find especially
large differences in the neurotransmitter composition between unidirectional
and reciprocal connections. Comparing the edge strengths
of reciprocal excitatory–inhibitory (ach–GABA) connections within
neuropil subnetworks, we observe that excitatory–inhibitory connection
strengths are more strongly correlated in some neuropils
(such as the FB and NO) than in others (Fig. 5f and Extended Data
Fig. 7a,b). These correlations do not appear to be dependent on neuropil
size (Extended Data Fig. 7c).
Identifying NSRNs
We searched for intrinsic highly reciprocal rich-club neurons that make
the majority of their connections within a single neuropil, and found
1,863 neurons that meet these criteria (Fig. 5g). These neuropil-specific
highly reciprocal neurons (NSRNs) are predominantly inhibitory:
54% are GABAergic and another 10% are glutamatergic (Extended Data
Fig. 7d). In some neuropils, such as the AL and EB, there are many NSRNs,
while in other neuropils, there exist only a handful of such neurons.
Some NSRNs, like the APL neurons in the MB42, CT1 neurons in the lobula
(LO)43 or AL local neurons (ALLNs)44, are known to provide global
feedback inhibition in these regions. These neurons tend to be highly
branched, with individual processes making reciprocal connections
with different feedforward neurons. Some have been shown to have
compartmentalized activity, raising the possibility of local computation45,46.
NSRNs that have yet to be characterized may have similar roles
in other circuits—for example, it is likely that NSRNs found in the AVLP
provide feedback to the auditory circuits in this region47.
Interneuropil reciprocal connections
While many reciprocal connections occur within single neuropils,
12.1% of all reciprocal pairs are formed by connections in two neuropils
(Methods). Mapping these reciprocal connections, we find off-diagonal
terms that represent pairs connecting across neuropils (Fig. 5h). The
compartments of the MB are linked by many reciprocal connections,
while the neuropils of the suboesophageal zone, including the GNG,
saddle (SAD) and prow (PRW), form a connected block. Strong reciprocal
connectivity also occurs across the midline, such as between the left
and right ALs. Neuropils close to the midline, such as superior medial
protocerebrum (SMP), superior posterior slope (SPS) and inferior
posterior slope (IPS), tend to have many cross-hemispheric reciprocal
connections. There also exist reciprocal connections that span the
central brain, such as those between the left and right anterior optic
tubercles (AOTUs) or the left and right lateral accessory lobes (LALs),
demonstrating that recurrent motifs are not limited to local connections—
they also exist at large spatial scales. Examples of such pairs are
shown in Extended Data Fig. 7e.
We also compared the map of reciprocal connections to the projectome
map of all connections (figure 4 of ref. 3). For example, the superior
lateral protocerebrum (SLP) and superior intermediate protocerebrum
(SIP) are connected to the FB in the projectome but have no reciprocal
connections. Similarly, the laminae has many internal connections but
few reciprocal ones. Examining ach–GABA reciprocal connections
highlights deviations from symmetry that represent a net imbalance of
excitatory–inhibitory reciprocal connections (Extended Data Fig. 7f).
For example, between the LO and PVLP, most ach–GABA reciprocal
connections share directionality: the ach connections are in the LO
and the GABA connections are in the PVLP.
Three-node motifs differ across regions
We computed the prevalence of three-node motifs in each neuropil
subnetwork relative to ER and CFG null models (Fig. 6a and Extended
Data Fig. 8a). Across most neuropils, we observed the same trend as
we do across the entire brain: an under-representation of feedforward
motifs (1–3) and an over-representation of complex motifs (Fig. 6b).
However, there are notable differences between neuropils. In the cantles,
epaulettes and gorgets, for example, the frequency of three-node
motifs was closer to that expected in a CFG null model, while, in the FB
and EB, complex motifs are particularly over-represented, consistent
with their high reciprocity (Fig. 6b).
Feedforward loops (motif 4) are over-represented in most neuropils,
except for the FB, EB, NO and MB compartments. This suggests
a relative under-representation of both feedforward excitatory and
feedforward inhibitory circuits in these brain regions. 3-unicycles
(motif 7), an indirect feedback inhibition circuit, are over-represented
across the entire brain (Fig. 3c) but are under-represented in most neuropils.
The notable exceptions, the ME and GNG, are very large neuropils
with many sensory inputs. The over-representation of 3-unicycles in the
ME implies the existence of localized cyclic structures in early visual
circuitry. Notably, this motif is also over-represented in the zebrafish
oculomotor circuit12. Motifs 7–10 are under-represented in the ALs,
perhaps a result of the small number of unidirectional edges in these
regions.
In most neuropils, we find that edges participating in underrepresented
motifs are weaker on average than edges participating
in over-represented motifs (Fig. 6c), and that edges participating in
three-node motifs are stronger than average (Extended Data Fig. 8b).
This is broadly consistent with the whole-brain three-node motif
strength results. A notable exception is the laminae, where feedforward
connections are strong despite being under-represented.
Discussion
The completion of a wiring diagram of the full brain of D. melanogaster
enabled us to characterize its network properties, laying the groundwork
for connecting circuit motifs to biological function. Our analysis
leverages spatial information, neuron class distinctions (for example,
sensory neurons versus descending neurons), cell type labels (annotations)
and neurotransmitter predictions to interpret the network
features we uncovered. Despite its sparsity, the fly brain is a robust
and highly interconnected network, with over-represented reciprocal
and recurrent motifs spanning multiple brain regions. These
long-range connections may explain results from recent brain-wide
neural recording experiments in fly48–50 and other species51–53 that have
uncovered widespread activity related to both sensory processing
and behaviour (beyond canonical pathways and brain regions). We
provide searchable and filterable lists of the neurons discussed in
this study, as well as a motif search and visualization tool to facilitate
hypothesis generation and model development online through Codex
(https://codex.flywire.ai).
Limitations
The availability of neurotransmitter predictions4, for at least ach, GABA,
glut, da, ser and oct, greatly enhanced our ability to interpret the circuit
motifs we identified in the connectome. However, although neurotransmitter
predictions are 94% accurate when compared to a set of ground
truth neurons, there are cases in which the predicted neurotransmitter
does not align with the known transmitter. Here we manually corrected
the Kenyon cells to be cholinergic (Methods). There may exist
other populations that are also systematically misidentified, but which
currently lack ground truth neurotransmitter information. While we
assume that neurons obey Dale’s law (each releasing only one neurotransmitter),
there are several known examples of co-transmission in
Drosophila54. It remains unclear how widespread neurotransmitter
co-transmission is. Note also that the synaptic connectome does not
provide a complete picture of information flow in the brain. We do not
currently have a map of gap junction synapses in the fly or of the extent
of neuropeptide signalling55.
Some analyses, particularly those dependent on network topology,
are sensitive to our choice of synapse threshold. While connectomes in
C. elegans have been proofread to the level of individual synapses21,27,35,
this is not feasible in larger datasets2,3,31. We therefore rely on automated
synapse detection algorithms with a non-negligible error
rate28. Not all synapses are successfully attached to neurons, and this
completion rate varies across brain regions3. Although some of these
low-synapse-number connections may be spurious, it is likely that
some weak connections persist across individuals, as has been found in
C. elegans27. Our companion paper on the fly optic lobe has found that
a lower synapse threshold is important for correct cell type identification
in those brain regions, further suggesting the importance of
some low-synapse connections56. Here we applied a consistent and
conservative threshold of five synapses per connection between
neurons (analysing 2.6 million connections instead of 14.7 million
unthresholded connections; Extended Data Fig. 1b,c and Extended Data
Table 2), and we demonstrated that our interpretations of connected
components, sparsity, reciprocity and clustering coefficients are not
dependent on this threshold. It is likely that the fly brain is more strongly
interconnected than the results here indicate.
Local circuit motifs are often inferred to be feedforward or feedback
connections. However, it is difficult to place local circuits in the context
of global directionality from sensory input to motor output. In shallow
networks, the directionality of the wiring diagram is clear. However, the
larger the network becomes, the more difficult it becomes to establish
directionality. In this study, we used an information flow method to
rank neurons relative to various sensory modalities3. Ultimately, directionality
of information flow in particular circuits, especially those in
regions of the brain far from sensory inputs or motor outputs, must
be determined experimentally.
Neuropil-specific differences
Different neuropils in Drosophila are known to have different functions.
Studying network topology at the brain scale enables us to highlight
how these functional differences are subserved by network differences.
For example, the MBs are known to be a centre for learning and memory
in the fly brain32. We find in the MB compartments the largest fraction
of dopaminergic connections (Extended Data Fig. 5d), the biggest
differences between reciprocal and unidirectional neurotransmitter
percentages (Fig. 5d,e), and a three-node motif distribution close to
that of null models (Fig. 6a,b). This combination of network characteristics
is unique across the neuropils of the brain. Another well studied
neuropil, the EB, is known to be involved in navigation, supporting
persistent activity correlated to heading direction57–59. We observed
that the EB has one of the highest reciprocity rates (Fig. 5c), one of the
highest average connection strengths (Extended Data Fig. 6b) and
very large over-representations of highly recurrent three-node motifs
(Fig. 6a,b). This represents a unique combination of neuropil-scale
network properties. By contrast, while the GNG has a similar three-node
motif profile (Fig. 6b and Extended Data Fig. 8a), it has much lower
The rich club and anatomical bottlenecks
The anatomy of the fly brain suggests two potential bottlenecks: one
between left hemisphere and right hemisphere and one between the
central brain and optic lobes. Only 12% of neurons cross hemispheres
and 6% of neurons cross between the central brain and optic lobes3,5.
Despite these bottlenecks, the brain is still robustly interconnected
with short path lengths. The large rich-club regime in the fly brain may
explain these short path lengths. When compared to the average neuron
in the brain, rich-club neurons are more likely to contain synapses in
both hemispheres, and are also more likely to connect the optic lobes to
the central brain. The broad spatial reach of these rich-club neurons also
keeps path lengths short across these bottlenecks. In the human brain,
it has been proposed that rich-club hubs in functional connectomes
help keep path lengths short. In the fly brain, we see that the rich-club
neuron population indeed contributes to short path lengths. Future
functional experiments in the fly focusing on the rich-club population
may shed light on whether this is the case at the neuron scale.
We also expect that the ascending and descending neurons, which
form a bottleneck between the brain and the VNC, will be part of the
central nervous system rich club. Many ascending and descending
neurons appear to have high degrees when examined within either
the brain or the VNC60. We await the completion of a complete CNS
connectome to verify the rich-club membership of such neurons.
The very-high-degree regime
Our rich-club analysis showed that we enter a rich-club regime above
total degree 37. However, as we continue to remove neurons, we find
that the population of neurons above degree ~100 are no longer
preferentially connected relative to either CFG or NPC random networks
(Fig. 1h and Extended Data Fig. 2e–g). On the basis of the SCC
and WCC survival curves (Fig. 1g and Extended Data Fig. 2b), these
very-high-degree neurons do not form multiple islands of connectivity.
Rather, the first connected component persists until nearly all neurons
are removed, and the second connected component never approaches
the size of the first. The under-representation of connections between
the very highest degree neurons is correlated with neurotransmitter
composition—most are GABAergic (Extended Data Figs. 2e,f,h and 3d).
These very large GABAergic neurons are less likely than chance to form
connections with each other.
Comparing connectomes across animals
Comparing network properties across different species has the potential
to uncover conserved and divergent properties of brain organization.
Similarities in reciprocity and clustering coefficient across
animals, which vary substantially in both size and connection density
(Table 2), hint at the possibility that some features of circuit architecture
may be broadly conserved across nervous systems (or that
brains optimize for these features). However, comparisons of graph
metrics across networks of different sizes, even for neuron-normalized
metrics such as reciprocity and clustering coefficient, must be made
with care36–38. Moreover, as mentioned previously, differences in proofreading
and thresholding will impact topological metrics, which treat
all edges as equivalent. Applying the same threshold across datasets
does not resolve this, as a given number of synapses may have different
biological implications across species. It has also been observed, both
in this work and in past studies, that different parts of the brain of the
fly differ in their connectivity properties31,33. It is likely that the same is
true in larger brains, meaning that statistics derived from partial wiring
diagrams may not be representative.
In C. elegans, there is substantial variability in the connectomes of
genetically identical individuals27. Comparisons between the FlyWire
and hemibrain datasets have already revealed similarities and differences
between individual flies, as outlined in our companion paper5, but
more datasets will be needed before we fully understand the variability
between individuals in Drosophila. Fortunately, more whole-brain
connectomes are on the horizon. The network analysis of the fly brain
presented should serve as a valuable baseline for comparison, both to
the connectomes of other Drosophila individuals and to the connectomes
of other species, to identify which network features are common
and which are species- or individual-specific.